# Chemical Properties prediction and visualized. 
<span style="color: green;">Structural properties similarity searching</span>  
<span style="color: green;">Molecular visualizations</span>

## Whats is ChemmineR?
ChemmineR is an R package under the BioConductor library that is designed for the analysis and visualization of chemical data, especially on molecules and compounds. Below are some of its key features; 

1. **Visualization**: It provide tools that visualize the chemical structures and theor relationships. This make it easier to interpret and communicate your findings. 
2. **Chemical Structure Handling**: ChemmineR can read, write, and manipulate chemical structures. These structures are stored in file formats like SDF and SMILES which are the industry standard ways to describe the molecular structure in text format. 
3. **Clustering**: ChemmineR can identify patterns and relationships between different molecules by grouping the like ones together.
4. **Structure Similarity Search**: ChemmineR can compare different chemical structures and find their similarity and how useful they are for certain tasks like identifying compounds that may have similar properties or biological effects. 

## Installation 
The `ChemmineR` package can be installed from R with: 

```
if(!requireNamespace("BioManager", quitely=TRUE))
install.packages("BioManager")
BiocManager::install("ChemminerR")
```

## Loading the package and Documentation 
The below command is called to invoke the `ChemmineR` package to the program 
```{r error=FALSE, warning=FALSE, message=FALSE}
library("ChemmineR") # Loads the package
```

To find the documentation and list all functions and classes call the command below
```
library(help="ChemmineR") # Lists all the functions and classes
```

To open a PDF manual for `ChemmineR` documentation from R
```
vignette("ChemmineR")
```

## Create Instances of SDFset class

```{r}
data("sdfsample")
```

```{r}
sdfset <- sdfsample
sdfset[1:4] #subsetting of object
```

To return a summarized content of one SDF
```{r}
sdfset[[1]]
```

## Retrieving atom, bond and data block
**Atom block**

```{r}
atomblock(sdfset[1:4])
atomblock(sdfset[1])[1:4]
```

**Bond block**
```{r}
bondblock(sdfset[1:4])
bondblock(sdfset[1])[1:4]
```

**Data Block**
```{r}
datablock(sdfset[1:4])
```

### Assigning compound IDS and keeping them unique

Return IDs from SDFset object
```{r}
cid(sdfset)[1:4]
```

Returns IDs from SD file header 
```{r}
unique_ids <- makeUnique(sdfid(sdfset))
cid(sdfset) <- unique_ids
```


### Converting the data blocks in an SDFset to a matrix
These data blocks can also be converted to a matrix by 

```{r}
blockmatrix <- datablock2ma(datablocklist = datablock(sdfset))
```

The matrix can also be split into numeric and character matrix by `splitNumChar()` function
```{r}
numchar <- splitNumChar(blockmatrix = blockmatrix)
```

Slice the numeric matrix 

```{r}
numchar[[1]][1:2,1:2]
```

Slice the character matrix 
```{r}
numchar[[2]][1:2, 10:11]
```

### Compute atom frequency matrix, molecular weight and formula 

```{r}
propma <- data.frame(MF=MF(sdfset),
                     MW=MW(sdfset), atomcountMA(sdfset))

propma[1:4,]
```

Assign matrix data to data block 
```{r}
datablock(sdfset) <- propma
datablock(sdfset[1]) # call the first compound in the databases 
```

### String searching in SDFset

Returns the  summary view of the matches 
```{r}
grepSDFset("650001", 
           sdfset,
           field="datablock",
           mode="subset")
```
Search by index
```{r}
grepSDFset("650001", 
           sdfset,
           field="datablock",
           mode="index")
```

## Molecular visualization in R 

Export SDFset to SD file 

```{r}
write.SDF(sdfset[1:4], file="data/sub.sdf", sig=TRUE)
```

Plot molecule structure of one or many SDFs

```{r}
plot(sdfset[1:4], print=FALSE) # plots structures to R graphics device
```

Compound viewing in web browser
```
sdf.visualize(sdfset[1:4])
```

You save the image of the visualization
```{r}
save.image("nstc.Rdata")
```

# Resources
The complete documentation (with code) of the `ChemmineR` package can be found below here 
- https://www.bioconductor.org/packages/release/bioc/vignettes/ChemmineR/inst/doc/ChemmineR.html

